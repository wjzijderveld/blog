<?xml version="1.0" encoding="utf-8"?>
<rss>
    <channel>
        <title>blog.willem-jan.net</title>
        <link>http://blog.willem-jan.net</link>
        <description>On this blog I try to regularly talk about my experiences with development.</description>
        <language>en</language>
                <item>
            <title>PHPCR: Query Object Model</title>
            <description><![CDATA[<p>This post is the third in a serie about PHPCR with Jackalope. In the <a href="http://blog.willem-jan.net/2013/11/16/setup-jackalope-with-mysql">first post</a> we've setup our repository, in
<a href="http://blog.willem-jan.net/2013/11/26/phpcr-reading-and-writing">the second</a> we talked about reading and writing from and to our repository.</p>

<p>In this post, we will continue with the reading part, but this time by using queries. For this, PHPCR has multiple
possibilities. On of them is the Query Object Model (QOM) with a Factory. At first this can seem a bit verbose, but I
hope to make clear why that is. Besides the QOM, there is also the possibility to use JCR-SQL2 queries. A Query language
very similar to SQL, which (in the case of Jackalope DoctrineDBAL) gets converted to the QOM. Jackalope Jackrabbit uses
SQL2 to communicate with Jackrabbit. There are 2 other query methods (SQL1 and XPath), but I'm not showing those in this
serie.</p>

<p>For the examples I use in this post, I created <a href="https://github.com/wjzijderveld/phpcr-blog-serie/blob/part3-query-and-querybuilder/src/Wjzijderveld/Resources/data/fixtures.xml">a fixture file</a> to load. This is loaded in the <a href="https://github.com/wjzijderveld/phpcr-blog-serie/blob/part3-query-and-querybuilder/src/Wjzijderveld/Command/QOMCommand.php">new Command</a> I added.</p>

<p>But before we can start with querying, we need to understand what we are querying and how we limit the results. With
PHPCR you're not querying tables or collections in a way you might be used to with SQL or NoSQL databases. When you
create a query you specify a <code>selector</code> (or multiple if the repository supports joins). So, when you want to query for
all files, without knowing where they are in your tree, you simply use the following query.</p>

<pre><code class="language-php">$factory = $session-&gt;getWorkspace()-&gt;getQueryManager()-&gt;getQOMFactory();
$source = $factory-&gt;selector('file', 'nt:file');
$qom = $factory-&gt;createQuery($source);
$result = $qom-&gt;execute();
</code></pre>

<p>Or with JCR-SQL2</p>

<pre><code class="language-php">$result = $session-&gt;getWorkspace()-&gt;getQueryManager()
                  -&gt;createQuery("SELECT * FROM [nt:file]",
                                QueryInterface::JCR_SQL2);
</code></pre>

<p>Already you can see the difference in verbosity of both methods. Because of this, you will probably use JCR-SQL2 when
building your queries. But in this post I will the QOM Factory for the most examples because (IMHO) that shows a bit
better what parts make up a query.</p>

<p><strong>Update:</strong> Instead of working with the QOMFactory directly, you can also work with the more fluent QueryBuilder that's
provided by PHPCR Utils.</p>

<pre><code class="language-php">$qomFactory = $session-&gt;getWorkspace()-&gt;getQueryManager()-&gt;getQOMFactory();
$queryBuilder = new \PHPCR\Util\QOM\QueryBuilder($qomFactory);
$queryBuilder
    -&gt;from($qomFactory-&gt;selector('file', 'nt:file'))
    -&gt;where($qomFactory-&gt;descendantNode('file', '/documents'))
    -&gt;execute();
</code></pre>

<h2>Basic conditions</h2>

<p>In the fixture file, I created some news items which we are going to query. The items have the nodeType <code>nt:unstructured</code>
so that's the what we are quering for. For the first example we are just retrieving all items, which are placed under
<code>/queryExamples/news</code>.</p>

<p>We first need to define what selector we are going to use.</p>

<pre><code class="language-php">/** @var QueryObjectModelFactoryInterface $qomFactory */
$qomFactory = $session-&gt;getWorkspace()-&gt;getQueryManager()-&gt;getQOMFactory();
$source = $qomFactory-&gt;selector('news', 'nt:unstructured');
</code></pre>

<p>The first parameter is the name of the selector which you get to choose yourself, you might call it an alias. The second
is the primary nodeType we are querying for, so in this case <code>nt:unstructured</code>.</p>

<p>Now we can define what columns we want to return in the results. For this example we only select the title.</p>

<pre><code class="language-php">$titleColumn = $qomFactory-&gt;column('news', 'title', 'title');
</code></pre>

<p>The first parameter is the selector from which we wan't to select something. The second parameter is the property we
want to select and the third is the name we want to use in the column, like an alias.</p>

<p>Next, we create the query with a condition to limit the nodes by path. This is called the <code>DescendantNodeConstraint</code>.</p>

<pre><code class="language-php">$qom = $qomFactory-&gt;createQuery(
    $source,
    $qomFactory-&gt;descendantNode('news', '/queryExamples/news'),
    array(),
    array($titleColumn)
);
</code></pre>

<p>The first parameters defines the selector to query from, the second is the condition for the query. The next parameter
defines the order of the results. The last parameter are the columns to select. The first parameter of the constraint
tells which selector we want to user, the second is under what path we want to select nodes.</p>

<p>Now we are ready to execute the query and loop over he results.</p>

<pre><code class="language-php">$result = $qom-&gt;execute();
foreach ($result-&gt;getRows() as $newsItem) {
    echo $newsItem-&gt;getValue('title');
}
</code></pre>

<p>Now we have our first results, we are going to limit our newsItem based on author. This is a simple PropertyValue
constraint. But because we now have 2 constraints, we need to alter our constraint to an <code>AndConstraint</code> and it becomes
very clear that the QOM Factory can get very verbose.</p>

<pre><code class="language-php line-numbers">$qom = $qomFactory-&gt;createQuery(
    // SelectorInterface
    $qomFactory-&gt;selector('news', 'nt:unstructured'),
    // AndInterface
    $qomFactory-&gt;andConstraint(
        // DescendantNodeInterface
        $qomFactory-&gt;descendantNode('news', '/queryExamples/news'),
        // ComparisonInterface
        $qomFactory-&gt;comparison(
            // PropertyValueInterface
            $qomFactory-&gt;propertyValue('news', 'jcr:author'),
            // 'jcr.operator.equal.to'
            QueryObjectModelConstantsInterface::JCR_OPERATOR_EQUAL_TO,
            // LiteralInterface
            $qomFactory-&gt;literal('foo')
        )
    ) // No orderings or columns for this example
);
echo count($qom-&gt;execute()-&gt;getRows()); // 2
</code></pre>

<p>This seems like a lot of code for a simple query, so I'll try to explain why that is. You already can see that there
are different kind of constraints. You don't always compare 2 properties but, as already used, you might need to test
if the nodes are descendants of a specific node, or if the node is a direct child of a given node. Or maybe you only
need to query nodes that have a specific property. Now everything is an object, it's way easier to walk the query to be
able toe execute it.</p>

<h2>More operands</h2>

<p>The next queries have a bit more constraints, and a constraint that you might expected to work differently.
We are going to query for nodes under <code>/queryExamples/news</code>, where the author is <strong>NOT</strong> <code>bar</code> <strong>AND</strong> where the node
does <strong>NOT</strong> have a categories property <strong>OR</strong> where the node contains a category <code>foo</code>. Then we order the result based
on NodeName in descending order.</p>

<pre><code class="language-php line-numbers">$qom = $qomFactory-&gt;createQuery(
    $source,
    // First and constraint
    $qomFactory-&gt;andConstraint(
        // Descendant constraint
        $qomFactory-&gt;descendantNode('news', '/queryExamples/news'),
        // Second and constraint
        $qomFactory-&gt;andConstraint(
            // Compare author
            $qomFactory-&gt;comparison(
                $qomFactory-&gt;propertyValue('news', 'jcr:author'),
                QueryObjectModelConstantsInterface::JCR_OPERATOR_NOT_EQUAL_TO,
                $qomFactory-&gt;literal('bar')
            ),
            // Or constraint
            $qomFactory-&gt;orConstraint(
                // Check for missing property categories
                $qomFactory-&gt;notConstraint(
                    $qomFactory-&gt;propertyExistence('news', 'categories')
                ),
                // Or check for category foo
                $qomFactory-&gt;comparison(
                    $qomFactory-&gt;propertyValue('news', 'categories'),
                    QueryObjectModelConstantsInterface::JCR_OPERATOR_EQUAL_TO,
                    $qomFactory-&gt;literal('foo')
                )
            )
        )
    ),
    // Order nodes based on name
    array($qomFactory-&gt;descending($qomFactory-&gt;nodeName('news')))
);
</code></pre>

<p>We now receive 2 rows, <code>item2</code> and <code>item1</code> in that order.</p>

<h4>To keep in mind</h4>

<p>Especially with Doctrine DBAL there are a few limitations with querying. So is comparing dates a bit tricky because the
properties are stored in XML. A workaround would be to store the date as a numeric format, so it becomes a lot easier to
compare and order it.</p>

<h2>JCR-SQL2</h2>

<p>Now let's have a quick look at the JCR-SQL2 variant of above query. We can just generate that from the above code with
<code>$qom-&gt;getStatement();</code></p>

<pre><code class="language-sql">SELECT * FROM [nt:unstructured] AS news
WHERE (
    ISDESCENDANTNODE(news, [/queryExamples/news])
    AND (
        news.[jcr:author] &lt;&gt; 'bar'
        AND (
            NOT news.categories IS NOT NULL
            OR news.categories = 'foo'
        )
    )
)
ORDER BY NAME(news) DESC
</code></pre>

<p>As you can see, is that a lot shorter and probably more more readable then the QOM Factory version. But a JCR-SQL2 can
get hard to read when you build it dynamicly, so it definitely isn't always the better solution.</p>

<h2>Other constraints</h2>

<p>We already saw quit a few constraints and I named a few others. Here is a quick overview of all the constraints that
PHPCR defines.</p>

<ul>
<li>And <em>Combine 2 required constraints</em></li>
<li>ChildNode <em>Check parent node</em></li>
<li>Comparison <em>Compare 2 values, can be any operand</em></li>
<li>DescendantNode <em>Check if path is under specified path</em></li>
<li>FullTextSearch <em>Full text search</em></li>
<li>Not <em>Inverse given constraint</em></li>
<li>Or <em>Combine 2 optional constraints</em></li>
<li>PropertyExistence <em>Check if the node has a property</em></li>
<li>SameNode <em>Compare node with another node</em></li>
</ul>

<p><strong>NOTE</strong>
Not all constraints are available in the Jackalope DoctrineDBAL transport, so is the SameNodeConstraint not yet
implemented.</p>

<p>We might see some of these constraints begin used in future posts. But I guess most are pretty obvious in what they do.</p>

<h2>Next post</h2>

<p>In the next post, I'll tell more nodeTypes and mixins. I'll do that by using versionable as an example.</p>
]]></description>
            <pubDate>2013-12-09T22:00:00+01:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/12/09/phpcr-query-object-model</guid>
            <link>http://blog.willem-jan.net/2013/12/09/phpcr-query-object-model</link>
        </item>
                <item>
            <title>PHPCR: Reading and writing</title>
            <description><![CDATA[<p>This post is the second in a serie about PHPCR with Jackalope. If you want to know more about PHPCR, I recommend watching
<a href="http://phpcr.github.io/slides.html">the slides about PHPCR</a>.</p>

<p>In the <a href="http://blog.willem-jan.net/2013/11/16/setup-jackalope-with-mysql">previous post</a>, I talked about setting up your repository. In this post we will start playing with some actual
content.</p>

<h3>Insert data</h3>

<p>To show the basic usage of PHPCR, we are going to load some data into our repository. For this I used <a href="https://github.com/fzaninotto/Faker">Faker</a>.</p>

<pre><code class="language-bash">$ composer require fzaninotto/faker ~1.2
</code></pre>

<p>Because we are going to add more CLI scripts later on, I created a simple Symfony Console Application for this. I called
it <code>console</code> at placed it in the root. You can find the console and the Command <a href="https://github.com/wjzijderveld/phpcr-blog-serie/tree/part2-querying">on Github</a>.</p>

<p>With PHPCR, it is pretty easy to create new nodes. You simply call <code>addNode</code> on it's parent node. So before we can
create new nodes, we need to rootNode. You can request the rootNode from the PHPCR session.</p>

<pre><code class="language-php">$session = $this-&gt;getHelper('phpcr')-&gt;getSession();
</code></pre>

<p>Here we use the helper that we defined in cli-config.php in my previous post to get the Session. Now we have the
session, we can simply retrieve the rootNode with <code>$session-&gt;getRootNode();</code> With the rootNode, we can start creating
fake nodes.</p>

<pre><code class="language-php line-numbers">$faker = \Faker\Factory::create();
while (count($rootNode-&gt;getNodes()) &lt; 10) {

    try {
        $node = $rootNode-&gt;addNode($faker-&gt;word);

        $node-&gt;setProperty('title', $faker-&gt;name);
        $node-&gt;setProperty('body', $faker-&gt;text(1000));
    } catch (\PHPCR\ItemExistsException $e) {
        // Ignore, and try again
    }
}

$session-&gt;save();
</code></pre>

<p>On line 5, you see the <code>addNode</code>, the first argument you give it, is the nodeName. You can give a second argument, to
define the nodeType but in this case we will use the default value (which will be nt:unstructured).
On line 7 and 8, we set 2 properties with random values. The first argument is the name of the property, the second is
the value. You can also give a third parameter, to indicate the type, but this is not required as <a href="https://github.com/phpcr/phpcr/blob/master/src/PHPCR/PropertyType.php#L326">PHPCR will guess the
type</a> based on given value.</p>

<p>Because nodeNames need to be unique, Jackalope will throw a ItemExists Exception when we try to create 2 nodes with the
same name. As that might happen with random date, we just catch the exception and try again.</p>

<h3>Reading the data</h3>

<p>Now we have some fake data, we can try to query it again. We start with simply iterating over all the childNodes.
Because every Node implements <code>Traversable</code>, we can simply loop over a node to get its children.</p>

<pre><code class="language-php line-numbers">foreach ($rootNode as $childNode) {
    $name = $childNode-&gt;getName();
    $title = $body = null;
    if ($childNode-&gt;hasProperty('title')) {
        $title = $childNode-&gt;getProperty('title')-&gt;getValue();
    }
    if ($childNode-&gt;hasProperty('body')) {
        $body = $childNode-&gt;getProperty('body')-&gt;getValue();
    }
    // .. do something
}
</code></pre>

<p>All pretty straight forward. To retrieve propertyValues, there are a few alternatives. You can, for example, use some of
other property methods, to convert the property value to another type.</p>

<pre><code class="language-php">$dummyNode-&gt;setProperty('floatProperty', 3.1415);
$property = $dummyNode-&gt;getProperty('floatProperty');
var_dump($property-&gt;getString()); // string(6) "3.1415"
var_dump($property-&gt;getLong()); // int(3)
var_dump($property-&gt;getBoolean()); // bool(true)
var_dump($property-&gt;getBinary()); // resource(#) of type (stream)
</code></pre>

<p>Besides that, you can use <code>$node-&gt;getPropertyValue('propertyName')</code>. By passing the second argument, you can convert the
value to the desired type.</p>

<pre><code class="language-php">$dummyNode-&gt;getPropertyValue('floatProperty', \PHPCR\PropertyType::STRING); // string(6) "3.1415"
</code></pre>

<h3>Finding nodes</h3>

<p>You can also retrieve a node by it's path or multiple nodes by an array with paths</p>

<pre><code class="language-php">$dummyNode = $session-&gt;getNode('/dummy');
$nodes = $session-&gt;getNodes(array('/', '/dummy'));
</code></pre>

<p>Or retrieve a childNode by it's name:</p>

<pre><code class="language-php">$dummyNode = $rootNode-&gt;getNode('dummy');
// Note that we call this on $rootNode, not on $session
</code></pre>

<p>You can even find nodes by searching with wildcards:</p>

<pre><code class="language-php">$rootNode-&gt;getNodes('c*');
</code></pre>

<p>There is a lot more to learn about nodes and properties. In the following chapters some of those features will be
explained. If you want to learn more about the possibilities, you might want to look at the <a href="https://github.com/phpcr/phpcr-api-tests">PHPCR api tests</a>.</p>

<p>In the next post, we will play with Queries and the QueryObjectModel.</p>
]]></description>
            <pubDate>2013-11-27T23:30:00+01:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/11/26/phpcr-reading-and-writing</guid>
            <link>http://blog.willem-jan.net/2013/11/26/phpcr-reading-and-writing</link>
        </item>
                <item>
            <title>Setup Jackalope with MySQL</title>
            <description><![CDATA[<p>This post is the first in a serie about PHPCR with Jackalope. If you want to know more about PHPCR, I recommend watching
<a href="http://phpcr.github.io/slides.html">the slides about PHPCR</a>.</p>

<p>In this post I will walk through the first steps, setting up your Content Repository using Jackalope. In this case we
will use MySQL as storage, but in a future post, we will migrate our data to a Jackrabbit server.</p>

<h3>Install Jackalope</h3>

<p>First we will install Jackalope DoctrineDBAL. In this serie I will use <a href="http://getcomposer.org">composer</a>, and in the examples I assume it's
installed system wide, so the <code>composer</code> command is available.</p>

<pre><code class="language-bash">$ mkdir phpcr-tutorial &amp;&amp; cd phpcr-tutorial
$ composer require jackalope/jackalope-doctrine-dbal ~1.0
</code></pre>

<p>This will also install the base Jackalope package, the PHPCR and PHPCR-Utils packages and Doctrine DBAL (and their
dependencies).</p>

<p>To already be a bit prepared for switch storage backend later on, I setup a basic configuration that allows us to switch
easily later on. For this I installed symfony/yaml to parse the Yaml file.</p>

<pre><code class="language-bash">$ composer require symfony/yaml ~2.3
</code></pre>

<p>The next step is to create your database and configure Jackalope with the correct transport layer.</p>

<h3>Configure jackalope</h3>

<p>Jackalope provides a file that gives us some powerfull CLI commands. For this to work, we need to tell Jackalope what
repository connection we are using. Jackalope requires a cli-config.php file for that in the root of your project.
In that file, we need to define the connection, but we can also add a HelperSet to the CLI. The HelperSet will contain
the PHPCR session, so Jacklope CLI has something to talk to.</p>

<p>Luckily Jackalope provides an <a href="https://github.com/jackalope/jackalope-doctrine-dbal/blob/master/cli-config.php.dist">example file</a>, so we see how the connection is created. (For Jackrabbit, there is a
similar <a href="https://github.com/jackalope/jackalope-jackrabbit/blob/master/cli-config.php.dist">example file</a>)</p>

<p>For this example, I created a bit of a revised version, to be prepared for the switch later. But you can choose to just
use the example provided by Jackalope Doctrine DBAL if you like. The full file I created can be found at <a href="https://github.com/wjzijderveld/phpcr-blog-serie/blob/part1-setup/cli-config.php">github</a>.
Below you will find the instantiation of the repository. Based on the config file, it's
decided which Jackalope Repository is created. In this part we only implemented the Doctrine DBAL version.</p>

<pre><code class="language-php">use \Doctrine\DBAL\DriverManager;
switch ($config['jackalope']['transport']) {
    case 'jackalope-doctrine-dbal':
        $dbConnection = DriverManager::getConnection(array(
            /* database connection variables $config['jackalope']['dbal'] */
        ));

        $factory = new \Jackalope\RepositoryFactoryDoctrineDBAL();
        $repository = $factory-&gt;getRepository(array(
            'jackalope.doctrine_dbal_connection' =&gt; $dbConnection
        ));

        break;
    case 'jackalope-jackrabbit':
        throw new \Exception('Jackrabbit bootstrap has not yet been defined');
        break;
    default:
        throw new \RuntimeException(sprintf('Invalid transport "%s" given', $config['jackalope']['transport']));
}
</code></pre>

<p>After that we need to actual login to the repository to be able to read and write data.</p>

<pre><code class="language-php">$credentials = new \PHPCR\SimpleCredentials($config['phpcr']['username'], $config['phpcr']['password']);
$session = $repository-&gt;login($credentials, $config['phpcr']['workspace']);

$helperSet = new \Symfony\Component\Console\Helper\HelperSet(array(
    'session' =&gt; new \PHPCR\Util\Console\Helper\PhpcrHelper($session)
));
</code></pre>

<p>Now we have the config file we can init the database.</p>

<pre><code class="language-bash">$ ./vendor/bin/jackalope jackalope:init:dbal
</code></pre>

<p>Jackalope will tell you it has initialized the database tables.</p>

<h3>Testing your repository</h3>

<p>You should now have a working repository. We can test this by executing our first query, which should return the rootNode</p>

<pre><code class="language-bash">$ ./vendor/bin/jackalope phpcr:workspace:query "SELECT * FROM [nt:unstructured]"
</code></pre>

<p>With this query, you request all notes with type <code>nt:unstructed</code>, which in this case, is only the rootNode.
Now we're done with the first part. In the next part, we will start with reading and writing to the repository via
Jackalope.</p>
]]></description>
            <pubDate>2013-11-16T00:00:00+01:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/11/16/setup-jackalope-with-mysql</guid>
            <link>http://blog.willem-jan.net/2013/11/16/setup-jackalope-with-mysql</link>
        </item>
                <item>
            <title>Symfony CMF</title>
            <description><![CDATA[<p>Today I got into a discussion about <a href="http://cmf.symfony.com">Symfony CMF</a>. The discussion started with the question, if Symfony CMF isn't trying
to create a solution for a problem that doesn't exists. That person thought CMF only solved a developers problem, but
couldn't solve the problems for front-end developers or editors (or even added more problems). It came down to it, that
he had seen the admin interfaces that come with Symfony CMF and saw that it was... less from perfect (to put it nice).</p>

<h4>Goals of Symfony CMF</h4>

<p>Symfony CMF aims to provide a toolbox to create your own custom CMS, not by reinventing the wheel, but by reusing
existing code and sharing the produced code (parts of it will be used in Drupal 8). It aims to make it easier for
developers to add CMS functionality to applications built on Symfony 2.</p>

<h4>PHPCR</h4>

<p>To do that, they looked at other solutions, solutions not limited to PHP, to structure content. This because a CMS has
mostly unstructured data, and forcing this into a RDBMS isn't always a good fit. <a href="https://en.wikipedia.org/wiki/Graph_database">Graph database</a> are a better
fit. They found <a href="http://jcp.org/en/jsr/detail?id=283">JCR</a>, a Java specification that deals with content. They ported that to PHP and called it <a href="https://github.com/phpcr/" title="PHPCR Github">PHPCR</a>;
PHP Content Repository. With PHPCR, there is an API to interface with your content repository.</p>

<h4>What is doesn't solve</h4>

<p>Althought Symfony CMF does provide some basic admin interfaces (with Sonata Admin), it isn't meant as an end product.
For most customers and editors, those screens just won't be enough. But there is nothing to stop you from developing
your own admin screens that does fit you customers needs.</p>

<p>Symfony CMF isn't a solution aimed at the end-user, that is still you job as a developer, to implement a solution that
helps your end-user and the editors. Symfony CMF just helps you to not get a panic attack when somebody tells you to add
content management to your Symfony2 application.</p>

<p>For more information about Symfony CMF, check the <a href="http://cmf.symfony.com/slides/bigpicture.html">bigger picture slides</a></p>
]]></description>
            <pubDate>2013-11-05T00:00:00+01:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/11/05/symfony-cmf</guid>
            <link>http://blog.willem-jan.net/2013/11/05/symfony-cmf</link>
        </item>
                <item>
            <title>So little time</title>
            <description><![CDATA[<p>As I mentioned 2 months ago, I believe it's important to keep developing yourself. You can't just sit there and
repeat the same trick every time. I also told that I wanted to do that by trying to find a new job, and by attending
more conferences and user groups.</p>

<p>But that all isn't that easy, I couldn't attend my user group because of a agenda conflict (and missing the next one as well)
and conferences are just to expensive to pay for by myself.</p>

<p>The work part isn't much better as well. I shouldn't complain, I still have a job! But at that job it is hard to find a
challenge, and there is a lot of repetitive work involved. And because there is a lot of Drupal involved, OOP isn't part
of my daily routine anymore, and that sucks.</p>

<p>While searching for a new job, I have found a company were I really want to work. The first job interview went well and
they are open to further conversation, but the sad part is, that they don't have a spot at this moment and they don't
know on what term they will.
And that's a pretty difficult time for me, I really want that job, but I'm not sure if I should wait for it. At this point
I'm not even sure if I actually would get hired, so is it worth the risk?</p>

<p>And with all this, it's hard to keep myself busy on the level were I want to be (and grow from there), At work there isn't
much room for it, and at home I can't spend the time at it that I would like (my wife would like some attention now and then :-) ).
So I try to put some time in a JAVA project I started 6 months ago, at least I'm working on a OO project.</p>

<p>Any tips how to deal with such a time would be greatly appreciated! Sometimes I have the feeling I'm just not patient enough,
that I should just wait, and be grateful I have a job.</p>
]]></description>
            <pubDate>2013-10-04T00:00:00+02:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/10/04/so-little-time</guid>
            <link>http://blog.willem-jan.net/2013/10/04/so-little-time</link>
        </item>
                <item>
            <title>My first uncon talk</title>
            <description><![CDATA[<p>About 2 months ago, when <a href="http://010php.nl">010php</a> started, I started playing with the idea of giving talks myself. At first
I was pretty anxious to actually execute that plan. I talked with some people that I had the idea and they all encouraged
me to do it. So I started writing down some ideas I already had. But until last week, I didn't actually had a talk planned
anywhere.</p>

<p>But last Tuesday, <a href="http://twitter.com/the_linie">Lineke</a> asked me if I would give a uncon talk at <a href="http://pfcongres.nl">PFcongres 2013</a>,
I don't think she new I was already playing with the idea, but she was very convincing and I said I would do my best to prepare
something.</p>

<p>Because of limited time, I started to prepare the evening before the conference, at that point I hadn't even decided what
subject I would choose for the talk... I decided on PHPCR and luckily the preperation went fairly well and I even rehearsed
it once!</p>

<p>So yesterday the conference was there, and on my way in the train I even managed to talk myself into a calmer state. Don't
get me wrong, I was still nervous as hell... just a bit less then before. I spoke to Linke en we planned my talk at 12.10.
After that I just went to the talks, trying not to think about it to much anymore. At <a href="http://joind.in/talk/view/8955">the talk just before my uncon slot</a>,
I got a bit nervous when Joshua already mentioned he didn't now if he would be done in time. Should I leave the talk early
to be on time? Should I just leave with everybody else? Eventually I decided that I would leave 5 minutes before my talk
started. That gave me some time to visit a restroom (to much coffee...), and still be on time for my talk. This meant I
walked out while Joshua was still answering some questions (sorry for that), but it made me feel a bit better.</p>

<p>Giving the talk went pretty well, of course I forgot to bring a VGA connector, but I could use Lineke's (thanks!). I pretty
much gave my talk as intended (only forgot to tell 1 thing), and got some good questions, so apparently people weren't bored
to death :)
Just before the end of my talk I noticed myself saying <em>Uhh</em> between pretty much every sentence, so I learned something
<strong>while</strong> giving the talk!</p>

<p>After the talk Lineke already gave me some feedback (she noticed the <em>Uhh</em>'s as well) and I spoke some people that had
seen it.
Another important thing I learned, is that a topic like PHPCR is very hard to explain, and nearly impossible to explain in
10-15 minutes, so next time I would probably want a 50min slot and I need to rethink how I can explain the subject to people
that have no clue about it. On a sidenote: you can still comment on my talk, so <strong>please</strong> <a href="https://joind.in/talk/view/9216">leave feedback</a>!</p>

<p>All with all was it a great experience and I'm certain I will do it again. Maybe I'll even submit a actual talk to a conference
next year.</p>
]]></description>
            <pubDate>2013-09-15T00:00:00+02:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/09/15/my-first-uncon-talk</guid>
            <link>http://blog.willem-jan.net/2013/09/15/my-first-uncon-talk</link>
        </item>
                <item>
            <title>Vespolina hackweekend</title>
            <description><![CDATA[<p>As I mentioned in <a href="/2012/06/02/working-on-opensource/">Working on an OpenSource project</a>,
I'm somewhat involved with <a href="http://www.vespolina.org">Vespolina</a>.
Last weekend we had our first hackweekend, <a href="https://github.com/inspiran">Daniel</a>
and I sat together, and <a href="https://github.com/iampersistent">Richard</a> and
<a href="https://github.com/cordoval">Luis</a> joined us remote. On friday evening
we had a conference call where <a href="https://github.com/hacfi">Philipp</a> also
joined us. In that conference call we talked a bit about what we wanted
to do that weekend.</p>

<p>The biggest change that we did that weekend, was merging some of the libraries
together in 1 lirbary. This to make it easier for people to start working
with Vespolina, and the make development easier, because maintaining around
40 repositories isn't trivial. Eventually the following libraries got merged
into <a href="https://github.com/vespolina/commerce">a single library</a>.</p>

<ul>
<li>Billing</li>
<li>Invoice</li>
<li>Order</li>
<li>Partner</li>
<li>Pricing</li>
<li>Product</li>
</ul>

<p>So essentially everything that was already done with the CommerceBundle,
but now for the libraries.</p>

<p>And I continued working on the new website and a bit on the documentation. The
website is almost finished, just needs some more content and probably some minor
bugfixes. But the documentation still needs lots of work.</p>

<p>In the coming weeks, I hope to continue working on writing documentation
and focus on writing more tests. The combination is probably a good way
to learn Vespolina better and hopefully lead to better documentation and tests.</p>
]]></description>
            <pubDate>2013-08-16T00:00:00+02:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/08/16/vespolina-hackweekend</guid>
            <link>http://blog.willem-jan.net/2013/08/16/vespolina-hackweekend</link>
        </item>
                <item>
            <title>Keep improving</title>
            <description><![CDATA[<p>About six months ago, I came to the conclusion that I needed to start thinking
about my future. The company I currently work at isn't growing as fast as
I am, so I started looking around to see how I could keep improving myself
and if that would be possible within this company. I learned a lot in the
years I work at the company, and always had a good time. So leaving the
company wasn't something I enjoyed thinking about. But after a while I came
to the conclusion I need to choose for myself, not for the company.</p>

<p>So I started looking around for the possibilities, trying to find out what
options I had in the Netherlands (because... that's were I live). Talked
to some people, tried to attend more conferences and user groups. At the
same time I started to contribute more to OpenSource. The more people I spoke
to and the more I saw and heared how other people were working, the more I
had the feeling I should be doing something else, there was so much I wanted
to do but wasn't able to at this moment.</p>

<p></p>

<p>I'm hoping to find a job were I can work with Symfony, were I can use TDD
and other QA techniques and tools. A job were I can put my hearth and soul
in exploring the possibilities of new techniques and implementing those
techniques. And if that includes working on and with OpenSource, that would
be awesome!</p>
]]></description>
            <pubDate>2013-08-02T00:00:00+02:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/08/02/keep-improving</guid>
            <link>http://blog.willem-jan.net/2013/08/02/keep-improving</link>
        </item>
                <item>
            <title>A new blog</title>
            <description><![CDATA[<p>Okay, so I started a new blog again.
This time I have the plan to force myself to write a post at least every 2 weeks,
but when possible every week. It's going to be hard, especially in the beginning.
But I think it's good for me to write down what I'm doing.</p>

<p>As this is the first post, I'll write about the software I used to build this.
It's called <a href="https://sculpin.io">Sculpin</a>, and it's a static site generator
written in PHP. It allows you to create a design with <a href="http://twig.sensiolabs.org">Twig</a> templates and
then write posts in any markup language you like (I'm using Markdown).</p>

<p>I like the fact that I can easily write a post now while being offline and
just deploy the project when I get online. The lack of a database is just
a nice elimination of another thing that can go wrong.</p>

<p>And for syntax highlighting I now use <a href="http://prismjs.com/">Prism.js</a>. A nice javascript library.
Sculpin supports Markdown Extra, so I can do the following:</p>

<pre><code>~~~language-markup
&lt;div id="foo"&gt;
    &lt;span class="bar"&gt;foobar&lt;/span&gt;
&lt;/div&gt;
~~~
</code></pre>

<p>And that will produce:</p>

<pre><code class="language-markup">&lt;div id="foo"&gt;
    &lt;span class="bar"&gt;foobar&lt;/span&gt;
&lt;/div&gt;
</code></pre>

<p>PHP Example:</p>

<pre><code class="language-php">&lt;?php
    $kernel = new AppKernel();
    $kernel-&gt;handle(Request::createFromGlobals());
    $kernel-&gt;terminate();
?&gt;
</code></pre>

<p>And of course there are more languages it can highlight.</p>

<p>I only haven't figured out how I can use the <a href="http://prismjs.com/plugins/line-numbers/">line-numbers</a> plugin within Markdown.</p>
]]></description>
            <pubDate>2013-07-26T00:00:00+02:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/07/26/new-blog</guid>
            <link>http://blog.willem-jan.net/2013/07/26/new-blog</link>
        </item>
                <item>
            <title>Created a little bundle check library</title>
            <description><![CDATA[<p>A few days back, I saw <a href="https://twitter.com/lsmith/status/283840720228470784">this tweet</a> of Lukas Smith.</p>

<blockquote>
  <p>has anyone written a #composerphp script to check which installed Bundles are not enabled in the applications #Symfony2 kernel?</p>
</blockquote>

<p>At first I just skipped it, thinking ‘Nope, next tweet’. But then I realized, it can’t be that hard, why don’t I build it?</p>

<p>So I started to work on it, and this time I actually finished it (probably because it didn’t take 2 weeks to build).
It was a nice little project, got to know Composer a bit better, got some more experience with UnitTesting (still need to write more tests though), had another go with Travis and submitted my first package to packagist.</p>

<p>I hope this gets met going again to actually make time to work on OSS (like Vespolina!).</p>

<p>Github: <a href="https://github.com/wjzijderveld/CheckBundles">https://github.com/wjzijderveld/CheckBundles</a><br />
Packagist: <a href="https://packagist.org/packages/wjzijderveld/check-bundles">https://packagist.org/packages/wjzijderveld/check-bundles</a></p>
]]></description>
            <pubDate>2013-02-26T00:00:00+01:00</pubDate>
            <guid>http://blog.willem-jan.net/2013/02/26/created-a-little-bundle-check-library</guid>
            <link>http://blog.willem-jan.net/2013/02/26/created-a-little-bundle-check-library</link>
        </item>
                <item>
            <title>Working on an OpenSource project</title>
            <description><![CDATA[<p>At the company I work at, we have a custom e-commerce
platform that’s in a need of replacement. The codebase is more then 6 years
old and by now, there are more exceptions that rules. The lack of actual MVC
implementation, an ORM or even a DBAL, made maintenance… not very pleasant.</p>

<p>Although we can’t just replace the platform, we did start looking at other
options to create a stable base for future development. For new features that
included a large bit of backend, we already created a new Symfony2 application.
That helped, but didn’t solve the spagetti frontend code. For some new frontend
features, we created a REST service in the Symfony2 application, and used
that in the old frontend application.</p>

<p>But to be able to create a new solid base for a new frontend we started looking
out for options. A completely custom Symfony2 application would simply cost to
much for the customer, a almost ready package as Magento is also an option, but
we weren’t really excited by the news of Ebay buying Magento.</p>

<p>We also looked at some Symfony2 Open Source projects, like Sylius and Vespolina.
Both projects weren’t very far when I started looking. But because Vespolina
started more as a Framework, I started to follow that project more closely.
After a few conversations on IRC with inspiran and iampersistent, I decided
to try and contribute to the project. At that point I had no idea if we ever
would be able to use Vespolina at our company, but I liked to project and just
wanted to help with an Open Source project.</p>

<p>I started with the Vespolina PartnerBundle. A bundle that would be responsible for creating and maintaining parterns in the application. A partner could be a lot more than a customer. It could also be a supplier, a company or a shop employee. The idea is, that the PartnerBundle could even be used in a CRM application.</p>

<p>We now are a few months further, and Vespolina is going steady. Unfortunately, I have little time to spare, so I can’t work on Vespolina as much as I like. At the company we haven’t made a decision about the platform, so I can’t spend time on Vespolina there.</p>

<p>I hope to create some time in the coming weeks. Really need to get going on the forms.</p>
]]></description>
            <pubDate>2012-06-02T00:00:00+02:00</pubDate>
            <guid>http://blog.willem-jan.net/2012/06/02/working-on-opensource</guid>
            <link>http://blog.willem-jan.net/2012/06/02/working-on-opensource</link>
        </item>
                <item>
            <title>Drupal and combined views</title>
            <description><![CDATA[<p>This week I started to work with Drupal 7, hadn’t worked with Drupal before, so was excited to explore the possibilities.</p>

<p>One of the goals was to familiarize  myself with Drupal and see if it is suited to create simple websites within a short time.</p>

<p>Somebody else started the project, so there were some blocks already created and a big piece of the theme was already build. I started with the thing I thought was most challenging, never expecting that to be pretty difficult.</p>

<p>The goal was about 2 entities, Services and Cases. Each Case having one service, and every Service having multiple Cases. I tried to create a page with 2 blocks, the first just plain text, the second a listing of Services. The challenge was to display the Cases for each Service in that same listing. Pretty soon I found that I required the module Views for that.</p>

<p>At first I tried with a module References, I created the 2 Entities, and added the Field Service to the Cases entity as a Node Reference</p>

<p>I did manage to join the two entities with a Relationship and grouping, but that didn’t got me very far. For every Case it would also repeat the Service description. After a lot of time in the Drupal IRC channel, I found that the problem was in the fact that I required more then 1 field from the Service Entity to be shown.</p>

<p>After a lot of help in the IRC channel, I found the following solution:</p>

<p>Just create 2 Views, one simple view with the Nodes of type Service. And a View with Nodes of type Cases, in that View I used a Contextual Filter for</p>

<p>In the template for the Description Field (in my case, can be any Field template), I called the function <code>views_embed_view</code>, that function does as the name says, it embeds another view. The first parameter is the machine_name of the view, the second paramater is the machine_name of the display in the view (You can find that under Advanced -> Other).</p>

<p>The third paramater Ihas some magic to it, because it accepts mixed data, but for me the following worked: <code>array(‘nid’ =&gt; $row-&gt;nid)</code>.</p>

<p>So the solution was to embed an View in a View, although there are modules that should do this, I haven’t found another way then modifying the template and using code.</p>

<p>I could write some sort of tutorial, a step by step explanation, just ask. For now this summary will do:</p>

<p>Used modules:</p>

<ul>
<li><a href="http://drupal.org/project/views">Views</a></li>
<li><a href="http://drupal.org/project/references">References</a></li>
</ul>

<p>Created 2 Views, use <code>views_embed_view</code> to embed the second view into the first one.</p>

<p>Also I have to say, the help I got on IRC was amazing, I probably was as unclear as a newbie can be, but they kept on asking question until they knew what I required.
Thanks RumpledElf and damiankloip (and some others that made a suggestion)!</p>

<p>Join <a href="irc://irc.freenode.org/drupal">#drupal</a> on <a href="http://www.freenode.org">freenode.org</a></p>
]]></description>
            <pubDate>2011-06-11T00:00:00+02:00</pubDate>
            <guid>http://blog.willem-jan.net/2011/06/11/drupal-combined-views</guid>
            <link>http://blog.willem-jan.net/2011/06/11/drupal-combined-views</link>
        </item>
            </channel>
</rss>